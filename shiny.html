<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Shiny | Community contributions for EDAV Fall 2019</title>
  <meta name="description" content="This book will hold all community contributions for STAT GR 5702 Fall 2019 at Columbia University" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Shiny | Community contributions for EDAV Fall 2019" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book will hold all community contributions for STAT GR 5702 Fall 2019 at Columbia University" />
  <meta name="github-repo" content="jtr13/cc19" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Shiny | Community contributions for EDAV Fall 2019" />
  
  <meta name="twitter:description" content="This book will hold all community contributions for STAT GR 5702 Fall 2019 at Columbia University" />
  



<meta name="date" content="2019-10-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="stamen-maps-with-ggmap.html"/>
<link rel="next" href="workshops.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html"><b>CC for EDAV 2019</b></a></li>

<li class="divider"></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Instructions</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#background"><i class="fa fa-check"></i><b>1.1</b> Background</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#preparing-your-.rmd-file"><i class="fa fa-check"></i><b>1.2</b> Preparing your <code>.Rmd</code> file</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#submission-steps"><i class="fa fa-check"></i><b>1.3</b> Submission Steps</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#optional-tweaks"><i class="fa fa-check"></i><b>1.4</b> Optional tweaks</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#faq"><i class="fa fa-check"></i><b>1.5</b> FAQ</a><ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#what-should-i-expect-after-creating-a-pull-request"><i class="fa fa-check"></i><b>1.5.1</b> What should I expect after creating a pull request?</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#what-if-i-catch-mistakes-after-my-pull-request-is-merged"><i class="fa fa-check"></i><b>1.5.2</b> What if I catch mistakes after my pull request is merged?</a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#other-questions"><i class="fa fa-check"></i><b>1.5.3</b> Other questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="sample-project.html"><a href="sample-project.html"><i class="fa fa-check"></i><b>2</b> Sample project</a></li>
<li class="part"><span><b>II Static Graphs</b></span></li>
<li class="chapter" data-level="3" data-path="ridgeline-plots.html"><a href="ridgeline-plots.html"><i class="fa fa-check"></i><b>3</b> Ridgeline plots</a><ul>
<li class="chapter" data-level="3.1" data-path="ridgeline-plots.html"><a href="ridgeline-plots.html#overview"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="ridgeline-plots.html"><a href="ridgeline-plots.html#tldr"><i class="fa fa-check"></i><b>3.2</b> tl;dr</a></li>
<li class="chapter" data-level="3.3" data-path="ridgeline-plots.html"><a href="ridgeline-plots.html#simple-examples"><i class="fa fa-check"></i><b>3.3</b> Simple examples</a></li>
<li class="chapter" data-level="3.4" data-path="ridgeline-plots.html"><a href="ridgeline-plots.html#theory"><i class="fa fa-check"></i><b>3.4</b> Theory</a></li>
<li class="chapter" data-level="3.5" data-path="ridgeline-plots.html"><a href="ridgeline-plots.html#external-resources"><i class="fa fa-check"></i><b>3.5</b> External resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="stamen-maps-with-ggmap.html"><a href="stamen-maps-with-ggmap.html"><i class="fa fa-check"></i><b>4</b> Stamen maps with ggmap</a><ul>
<li class="chapter" data-level="4.1" data-path="stamen-maps-with-ggmap.html"><a href="stamen-maps-with-ggmap.html#mutilayerd-plots-with-ggmaps"><i class="fa fa-check"></i><b>4.1</b> Mutilayerd plots with ggmaps</a></li>
<li class="chapter" data-level="4.2" data-path="stamen-maps-with-ggmap.html"><a href="stamen-maps-with-ggmap.html#getting-deeper"><i class="fa fa-check"></i><b>4.2</b> Getting Deeper</a></li>
</ul></li>
<li class="part"><span><b>III Interactive Graphs</b></span></li>
<li class="chapter" data-level="5" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>5</b> Shiny</a><ul>
<li class="chapter" data-level="5.1" data-path="shiny.html"><a href="shiny.html#part-1-how-to-build-a-shiny-app"><i class="fa fa-check"></i><b>5.1</b> Part 1 How to Build a Shiny App</a></li>
<li class="chapter" data-level="5.2" data-path="shiny.html"><a href="shiny.html#install-the-shiny-package"><i class="fa fa-check"></i><b>5.2</b> 1. Install the shiny package</a></li>
<li class="chapter" data-level="5.3" data-path="shiny.html"><a href="shiny.html#template-for-creating-a-shiny-app"><i class="fa fa-check"></i><b>5.3</b> 2. Template for creating a shiny app</a></li>
<li class="chapter" data-level="5.4" data-path="shiny.html"><a href="shiny.html#add-elements-to-user-interface-using-fluidpage"><i class="fa fa-check"></i><b>5.4</b> 3. Add elements to user interface using <code>fluidPage()</code></a><ul>
<li class="chapter" data-level="5.4.1" data-path="shiny.html"><a href="shiny.html#input-functions"><i class="fa fa-check"></i><b>5.4.1</b> Input functions</a></li>
<li class="chapter" data-level="5.4.2" data-path="shiny.html"><a href="shiny.html#output-functions"><i class="fa fa-check"></i><b>5.4.2</b> Output functions</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="shiny.html"><a href="shiny.html#build-output-in-server-instructions"><i class="fa fa-check"></i><b>5.5</b> 4. Build output in server instructions</a><ul>
<li class="chapter" data-level="5.5.1" data-path="shiny.html"><a href="shiny.html#save-objects-you-want-to-display-to-output"><i class="fa fa-check"></i><b>5.5.1</b> (1): Save objects you want to display to <code>output$</code></a></li>
<li class="chapter" data-level="5.5.2" data-path="shiny.html"><a href="shiny.html#build-objects-with-render"><i class="fa fa-check"></i><b>5.5.2</b> (2): Build objects with <code>render()</code></a></li>
<li class="chapter" data-level="5.5.3" data-path="shiny.html"><a href="shiny.html#use-input-values-with-input"><i class="fa fa-check"></i><b>5.5.3</b> (3): Use input values with <code>input$</code></a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="shiny.html"><a href="shiny.html#share-your-app"><i class="fa fa-check"></i><b>5.6</b> 5. Share your app</a><ul>
<li class="chapter" data-level="5.6.1" data-path="shiny.html"><a href="shiny.html#save-your-app"><i class="fa fa-check"></i><b>5.6.1</b> Save your app</a></li>
<li class="chapter" data-level="5.6.2" data-path="shiny.html"><a href="shiny.html#publish-your-app-on-shinyapps.io"><i class="fa fa-check"></i><b>5.6.2</b> Publish your app on Shinyapps.io</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="shiny.html"><a href="shiny.html#part-2-how-to-customize-reactions"><i class="fa fa-check"></i><b>5.7</b> Part 2 How to Customize Reactions</a></li>
<li class="chapter" data-level="5.8" data-path="shiny.html"><a href="shiny.html#reactivity"><i class="fa fa-check"></i><b>5.8</b> 1. Reactivity</a><ul>
<li class="chapter" data-level="5.8.1" data-path="shiny.html"><a href="shiny.html#what-is-reactivity"><i class="fa fa-check"></i><b>5.8.1</b> What is reactivity?</a></li>
<li class="chapter" data-level="5.8.2" data-path="shiny.html"><a href="shiny.html#reactive-values"><i class="fa fa-check"></i><b>5.8.2</b> Reactive values</a></li>
<li class="chapter" data-level="5.8.3" data-path="shiny.html"><a href="shiny.html#reactive-functions-reactive-toolkit"><i class="fa fa-check"></i><b>5.8.3</b> Reactive functions (reactive toolkit)</a></li>
<li class="chapter" data-level="5.8.4" data-path="shiny.html"><a href="shiny.html#modularize-code-with-reactive"><i class="fa fa-check"></i><b>5.8.4</b> Modularize code with <code>reactive()</code></a></li>
<li class="chapter" data-level="5.8.5" data-path="shiny.html"><a href="shiny.html#prevent-reactions-with-isolate"><i class="fa fa-check"></i><b>5.8.5</b> Prevent reactions with <code>isolate()</code></a></li>
<li class="chapter" data-level="5.8.6" data-path="shiny.html"><a href="shiny.html#trigger-code-with-observeevent"><i class="fa fa-check"></i><b>5.8.6</b> Trigger code with <code>observeEvent()</code></a></li>
<li class="chapter" data-level="5.8.7" data-path="shiny.html"><a href="shiny.html#delay-reactions-with-eventreactive"><i class="fa fa-check"></i><b>5.8.7</b> Delay reactions with <code>eventReactive()</code></a></li>
<li class="chapter" data-level="5.8.8" data-path="shiny.html"><a href="shiny.html#manage-state-with-reactivevalues"><i class="fa fa-check"></i><b>5.8.8</b> Manage state with <code>reactiveValues()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="shiny.html"><a href="shiny.html#summary"><i class="fa fa-check"></i><b>5.9</b> 3. Summary</a></li>
</ul></li>
<li class="part"><span><b>IV Links</b></span></li>
<li class="chapter" data-level="6" data-path="workshops.html"><a href="workshops.html"><i class="fa fa-check"></i><b>6</b> Workshops</a><ul>
<li class="chapter" data-level="6.1" data-path="workshops.html"><a href="workshops.html#bookdown"><i class="fa fa-check"></i><b>6.1</b> bookdown</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="cheatsheets.html"><a href="cheatsheets.html"><i class="fa fa-check"></i><b>7</b> Cheatsheets</a><ul>
<li class="chapter" data-level="7.1" data-path="cheatsheets.html"><a href="cheatsheets.html#html-javascript-and-d3"><i class="fa fa-check"></i><b>7.1</b> HTML, JavaScript, and D3</a></li>
<li class="chapter" data-level="7.2" data-path="cheatsheets.html"><a href="cheatsheets.html#leaflet"><i class="fa fa-check"></i><b>7.2</b> Leaflet</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="videos.html"><a href="videos.html"><i class="fa fa-check"></i><b>8</b> Videos</a><ul>
<li class="chapter" data-level="8.1" data-path="videos.html"><a href="videos.html#cartodb"><i class="fa fa-check"></i><b>8.1</b> CartoDB</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Community contributions for EDAV Fall 2019</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="shiny" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Shiny</h1>
<p>Duanyue Yun, Boyu Liu</p>
<p>In this tutorial, we will use the cars dataset as an example to wall through the process of building a shiny app. The cars dataset contains various information about a particular car.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">cars_info &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;cars.csv&quot;</span>)</a></code></pre></div>
<p><img src="resources/shiny_tutorial/carsdata.png" /></p>
<div id="part-1-how-to-build-a-shiny-app" class="section level2">
<h2><span class="header-section-number">5.1</span> Part 1 How to Build a Shiny App</h2>
</div>
<div id="install-the-shiny-package" class="section level2">
<h2><span class="header-section-number">5.2</span> 1. Install the shiny package</h2>
<p>First of all, we can install the shiny package by running the code below.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">&quot;shiny&quot;</span>)</a></code></pre></div>
</div>
<div id="template-for-creating-a-shiny-app" class="section level2">
<h2><span class="header-section-number">5.3</span> 2. Template for creating a shiny app</h2>
<p>A shiny app consists of two main components: user interface (ui) and server instructions (server). The user interface will contain the elements that a user sees on your shiny app, which can be input (possible user interactions) and output display. The server instructions will define how the app should react to a user’s action.</p>
<p>Therefore, a basic template for creating a shiny app consists of 3 parts as shown below:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">#1 define user interface</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4">ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>()</a>
<a class="sourceLine" id="cb20-5" data-line-number="5"></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">#2 define server instructions</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {}</a>
<a class="sourceLine" id="cb20-8" data-line-number="8"></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#3 putting everything together</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="kw">shinyApp</span>(<span class="dt">ui =</span> ui, <span class="dt">server =</span> server)</a></code></pre></div>
</div>
<div id="add-elements-to-user-interface-using-fluidpage" class="section level2">
<h2><span class="header-section-number">5.4</span> 3. Add elements to user interface using <code>fluidPage()</code></h2>
<p>The arguments of the <code>fluidPage()</code> function could be <code>Input()</code> functions or <code>Output()</code> functions.</p>
<div id="input-functions" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Input functions</h3>
<p>Inputs define the possible ways a user can interact with our shiny App. For a numerical variable, the input could be a slider that a user can move along to select a certain value. For a categorical variable, the input could be a box where the user can select a particular category from a drop down list.</p>
<p>All <code>Input()</code> functions contain 2 required arguments: <code>inputId =</code> and <code>label =</code>. <code>inputId</code> is for us to identify a particular input. Later we can use the same input ID in server instructions to decide the corresponding output. Therefore, to avoid errors, it is better to give a unique name to each input. <code>label</code> is what the user sees on the shiny App, so it should be informative.</p>
<p>The common <code>Input()</code> functions supported are:</p>
<p><code>actionButton()</code>, <code>submitButton()</code>, <code>checkboxInput()</code>, <code>checkboxGroupInput()</code>, <code>dateInput()</code>,
<code>dateRangeInput()</code>, <code>fileInput()</code>, <code>numericInput()</code>, <code>passwordInput()</code>, <code>radioButtons()</code>, <code>selectInput()</code>,
<code>sliderInput()</code>, <code>textInput()</code>.</p>
<p>Each <code>Input()</code> function has some specific arguments. For example, the <code>sliderInput()</code> function requires min, max arguments to set the range of the slider and also a value argument which is the default value the user sees when the shiny app is launched. You can find more about the function using <code>?sliderInput()</code>.</p>
<p>For example, we can add a select box by running the code below.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb21-2" data-line-number="2">  <span class="co"># Add a select box</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3">  <span class="kw">selectInput</span>(<span class="dt">inputId =</span> <span class="st">&quot;varname&quot;</span>, </a>
<a class="sourceLine" id="cb21-4" data-line-number="4">              <span class="dt">label =</span> <span class="st">&quot;Choose a variable&quot;</span>, </a>
<a class="sourceLine" id="cb21-5" data-line-number="5">              <span class="dt">choices =</span> <span class="kw">colnames</span>(cars_info)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">7</span>)]))</a></code></pre></div>
<p><img src="resources/shiny_tutorial/selectbox.png" /></p>
</div>
<div id="output-functions" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Output functions</h3>
<p>We can display an output, for example a plot, by adding <code>Output()</code> functions to <code>fluidPage()</code>. Each <code>Output()</code> function requires one argument, which is <code>outputId =</code>. We will talk about how to build output in server instructions.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(<span class="kw">plotOutput</span>(<span class="st">&quot;histogram&quot;</span>))</a></code></pre></div>
<p>The common <code>Output()</code> functions supported are:</p>
<p><code>dataTableOutput()</code>, <code>htmlOutput()</code>, <code>imageOutput()</code>, <code>plotOutput()</code>, <code>tableOutput()</code>, <code>textOutput()</code>, <code>uiOutput()</code>, <code>verbatimTextOutput()</code>.</p>
</div>
</div>
<div id="build-output-in-server-instructions" class="section level2">
<h2><span class="header-section-number">5.5</span> 4. Build output in server instructions</h2>
<div id="save-objects-you-want-to-display-to-output" class="section level3">
<h3><span class="header-section-number">5.5.1</span> (1): Save objects you want to display to <code>output$</code></h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">      output<span class="op">$</span>histogram &lt;-<span class="st"> </span><span class="co"># code</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3">}</a></code></pre></div>
<p>We can use the same name in the form of a string in fluidPage() to display the output.</p>
</div>
<div id="build-objects-with-render" class="section level3">
<h3><span class="header-section-number">5.5.2</span> (2): Build objects with <code>render()</code></h3>
<p>The <code>render()</code> functions that are supported include <code>renderDataTable()</code>, <code>renderImage()</code>, <code>renderPlot()</code>, <code>renderPrint()</code>, <code>renderTable()</code>, <code>renderText()</code>, <code>renderUI()</code>.</p>
<p>Within <code>render()</code> functions, we could use <code>{}</code> to wrap the code so that we can write multiple lines of code to create more sophisticated output.</p>
<p>As an example, the following code builds a histrogram of the variable <code>mpg</code> to our shiny app. Remember to add it to <code>ui()</code> to display it in the shiny app.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">  output<span class="op">$</span>histogram &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">    <span class="kw">hist</span>(cars_info<span class="op">$</span>mpg, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;mpg&quot;</span>)</a>
<a class="sourceLine" id="cb24-4" data-line-number="4">  })</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">}</a></code></pre></div>
<p><img src="resources/shiny_tutorial/hist.png" /></p>
</div>
<div id="use-input-values-with-input" class="section level3">
<h3><span class="header-section-number">5.5.3</span> (3): Use input values with <code>input$</code></h3>
<p>When we use <code>input$</code>, the app will be interactive. For the following example, when the user selects a different variable, the histogram will change accordingly.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">  output<span class="op">$</span>histogram &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb25-3" data-line-number="3">    <span class="kw">hist</span>(cars_info[[input<span class="op">$</span>varname]], <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> input<span class="op">$</span>varname)</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">  })</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">}</a></code></pre></div>
</div>
</div>
<div id="share-your-app" class="section level2">
<h2><span class="header-section-number">5.6</span> 5. Share your app</h2>
<div id="save-your-app" class="section level3">
<h3><span class="header-section-number">5.6.1</span> Save your app</h3>
<p>You should save your app to one directory with every file the app needs:</p>
<ul>
<li><p>app.R (must be the exact file name)</p></li>
<li><p>datasets, images, css, helper scripts, etc.</p></li>
</ul>
</div>
<div id="publish-your-app-on-shinyapps.io" class="section level3">
<h3><span class="header-section-number">5.6.2</span> Publish your app on Shinyapps.io</h3>
<ol style="list-style-type: decimal">
<li>Go to <a href="https://www.shinyapps.io" class="uri">https://www.shinyapps.io</a> to sign up for an account.</li>
</ol>
<p><img src="resources/shiny_tutorial/shinyapps.io.png" /></p>
<ol start="2" style="list-style-type: decimal">
<li>When you signed up for a new account on <a href="https://www.shinyapps.io" class="uri">https://www.shinyapps.io</a>, there will be instructions on how to associate your account with your RStudio IDE and how to deploy your app.</li>
</ol>
<p><img src="resources/shiny_tutorial/newuserinstructions.png" /></p>
</div>
</div>
<div id="part-2-how-to-customize-reactions" class="section level2">
<h2><span class="header-section-number">5.7</span> Part 2 How to Customize Reactions</h2>
</div>
<div id="reactivity" class="section level2">
<h2><span class="header-section-number">5.8</span> 1. Reactivity</h2>
<div id="what-is-reactivity" class="section level3">
<h3><span class="header-section-number">5.8.1</span> What is reactivity?</h3>
<p>Let’s think about Microsoft Excel. In Excel, we can type some value into a cell x and type a formula that uses x into a new cell y. Then whenever we change the value in x, y’s value will change correspondingly. This is reactivity, which is also what Shiny does.</p>
<p>Shiny has an input object <code>input$x</code> and an output object <code>output$y</code>. Any changes in <code>input$x</code> will cause changes in <code>output$y</code>.</p>
<p>So now let’s start with reactive values, which is where reactivity starts in Shiny.</p>
</div>
<div id="reactive-values" class="section level3">
<h3><span class="header-section-number">5.8.2</span> Reactive values</h3>
<p>Reactive values are what the user selects and depend on <code>Input()</code> functions. In the previous example where we create a select box, the reactive values are the variable that the user selects.</p>
<p>Note that reactive values don’t work on their own. They actually work together with reactive functions.</p>
</div>
<div id="reactive-functions-reactive-toolkit" class="section level3">
<h3><span class="header-section-number">5.8.3</span> Reactive functions (reactive toolkit)</h3>
<ul>
<li><p>They are a kind of functions that are expected to take reactive values and know what to do with them.</p></li>
<li><p>They are notified that they need to re-execute whenever the reactive value changes.</p></li>
<li><p>They are included in the server instructions section to build (and rebuild) an object.</p></li>
</ul>
<p>We can think of reactivity in R as two-step process. Consider the following example. We use input function <code>selectInput()</code> to get user’s choice. <code>input$varname</code> is the reactive value. When we choose different variables, firstly reactive values will notify the functions which use them that they become outdated. After that its job is over and it’s time for reactive functions to do their jobs, which is rebuild the corresponding object using new values. The process is automatic in shiny.</p>
<p>Suppose we want to output the corresponding histogram whenever the user chooses a variable.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb26-2" data-line-number="2">  <span class="co"># Add a select box</span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3">  <span class="kw">selectInput</span>(<span class="dt">inputId =</span> <span class="st">&quot;varname&quot;</span>, </a>
<a class="sourceLine" id="cb26-4" data-line-number="4">              <span class="dt">label =</span> <span class="st">&quot;Choose a variable&quot;</span>, </a>
<a class="sourceLine" id="cb26-5" data-line-number="5">              <span class="dt">choices =</span> <span class="kw">colnames</span>(cars_info)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">7</span>)]),</a>
<a class="sourceLine" id="cb26-6" data-line-number="6">  </a>
<a class="sourceLine" id="cb26-7" data-line-number="7">  <span class="co"># Add corresponding output</span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8">  <span class="kw">plotOutput</span>(<span class="dt">outputId =</span> <span class="st">&quot;histogram&quot;</span>)</a>
<a class="sourceLine" id="cb26-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb26-10" data-line-number="10"></a>
<a class="sourceLine" id="cb26-11" data-line-number="11">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</a>
<a class="sourceLine" id="cb26-12" data-line-number="12">  output<span class="op">$</span>histogram &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb26-13" data-line-number="13">    <span class="kw">hist</span>(cars_info[[input<span class="op">$</span>varname]], <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> input<span class="op">$</span>varname)</a>
<a class="sourceLine" id="cb26-14" data-line-number="14">  })</a>
<a class="sourceLine" id="cb26-15" data-line-number="15">}</a>
<a class="sourceLine" id="cb26-16" data-line-number="16"></a>
<a class="sourceLine" id="cb26-17" data-line-number="17"><span class="kw">shinyApp</span>(<span class="dt">ui =</span> ui, <span class="dt">server =</span> server)</a></code></pre></div>
<p><img src="resources/shiny_tutorial/reactive.png" /></p>
</div>
<div id="modularize-code-with-reactive" class="section level3">
<h3><span class="header-section-number">5.8.4</span> Modularize code with <code>reactive()</code></h3>
<p>See the example below. When the user selects a number, the shiny app plots a histogram for that number of N(0,1) variables and also computes the summary statistics. This app has only one reactive value (number the user chooses) but has two objects, a histogram and a block of text which includes the statistics of the data. When the reactive value changes, it will notify these two objects and they will rerun the code to update themself. But the probelm is that because they rerun their code successively, so <code>rnorm(input$num)</code> is called twice. Since <code>rnorm</code> is random, each object generates a different set of values, which means the histogram describes a dataset and the summary of the statistics describes another dataset.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="co"># Before</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">  <span class="co"># Add a slider</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4">  <span class="kw">sliderInput</span>(<span class="dt">inputId =</span> <span class="st">&quot;num&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Please choose a number.&quot;</span>, </a>
<a class="sourceLine" id="cb27-5" data-line-number="5">  <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">100</span>, <span class="dt">value =</span> <span class="dv">25</span>),</a>
<a class="sourceLine" id="cb27-6" data-line-number="6">  </a>
<a class="sourceLine" id="cb27-7" data-line-number="7">  <span class="co"># Display the histogram</span></a>
<a class="sourceLine" id="cb27-8" data-line-number="8">  <span class="kw">plotOutput</span>(<span class="dt">outputId =</span> <span class="st">&quot;hist&quot;</span>),</a>
<a class="sourceLine" id="cb27-9" data-line-number="9">  </a>
<a class="sourceLine" id="cb27-10" data-line-number="10">  <span class="co"># Display the summary statistics</span></a>
<a class="sourceLine" id="cb27-11" data-line-number="11">  <span class="kw">verbatimTextOutput</span>(<span class="st">&quot;stats&quot;</span>)</a>
<a class="sourceLine" id="cb27-12" data-line-number="12">)</a>
<a class="sourceLine" id="cb27-13" data-line-number="13"></a>
<a class="sourceLine" id="cb27-14" data-line-number="14">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</a>
<a class="sourceLine" id="cb27-15" data-line-number="15">  <span class="co"># Build the histogram</span></a>
<a class="sourceLine" id="cb27-16" data-line-number="16">  output<span class="op">$</span>hist &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({<span class="kw">hist</span>(<span class="kw">rnorm</span>(input<span class="op">$</span>num), <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;num&quot;</span>)})</a>
<a class="sourceLine" id="cb27-17" data-line-number="17">  </a>
<a class="sourceLine" id="cb27-18" data-line-number="18">  <span class="co"># Build the object that contains the summary statistics</span></a>
<a class="sourceLine" id="cb27-19" data-line-number="19">  output<span class="op">$</span>stats &lt;-<span class="st"> </span><span class="kw">renderPrint</span>({<span class="kw">summary</span>(<span class="kw">rnorm</span>(input<span class="op">$</span>num))})</a>
<a class="sourceLine" id="cb27-20" data-line-number="20">  }</a>
<a class="sourceLine" id="cb27-21" data-line-number="21"></a>
<a class="sourceLine" id="cb27-22" data-line-number="22"><span class="kw">shinyApp</span>(<span class="dt">ui =</span> ui, <span class="dt">server =</span> server)</a></code></pre></div>
<p>For example, when we only select one normal variable. It is clear that the histogram and the summary statistics do not correpond to the same data.</p>
<p><img src="resources/shiny_tutorial/slider.png" />
<img src="resources/shiny_tutorial/hist1.png" />
<img src="resources/shiny_tutorial/sumstats.png" /></p>
<p>Can the two objects describe the same data? The answer is yes! The strategy is calling <code>rnorm(input$num)</code> only once and saving the dataset it creates. Then use this dataset downstream when we need it. Shiny provides a function called <code>reactive()</code>, which can wrap a normal expression to create a reactive expression and realize what we hope to achieve.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">reactive</span>(<span class="kw">rnorm</span>(input<span class="op">$</span>num))</a></code></pre></div>
<p>In this specific example, we add a code <code>data &lt;- reactive(rnorm(input$num))</code> to the server and replace <code>rnorm(input$num)</code> in the reactive functions with <code>data()</code>. Note that you should call a reactive expression like a function. So here we use <code>data()</code> instead of <code>data</code>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="co"># After</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2">ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb29-3" data-line-number="3">  <span class="kw">sliderInput</span>(<span class="dt">inputId =</span> <span class="st">&quot;num&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Please choose a number.&quot;</span>, </a>
<a class="sourceLine" id="cb29-4" data-line-number="4">  <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">100</span>, <span class="dt">value =</span> <span class="dv">25</span>),</a>
<a class="sourceLine" id="cb29-5" data-line-number="5">  <span class="kw">plotOutput</span>(<span class="dt">outputId =</span> <span class="st">&quot;hist&quot;</span>),</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">  <span class="kw">verbatimTextOutput</span>(<span class="st">&quot;stats&quot;</span>)</a>
<a class="sourceLine" id="cb29-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb29-8" data-line-number="8"></a>
<a class="sourceLine" id="cb29-9" data-line-number="9">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</a>
<a class="sourceLine" id="cb29-10" data-line-number="10">  data &lt;-<span class="st"> </span><span class="kw">reactive</span>(<span class="kw">rnorm</span>(input<span class="op">$</span>num))</a>
<a class="sourceLine" id="cb29-11" data-line-number="11">  output<span class="op">$</span>hist &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({<span class="kw">hist</span>(<span class="kw">data</span>(), <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;num&quot;</span>)})</a>
<a class="sourceLine" id="cb29-12" data-line-number="12">  output<span class="op">$</span>stats &lt;-<span class="st"> </span><span class="kw">renderPrint</span>({<span class="kw">summary</span>(<span class="kw">data</span>())})</a>
<a class="sourceLine" id="cb29-13" data-line-number="13">}</a>
<a class="sourceLine" id="cb29-14" data-line-number="14"></a>
<a class="sourceLine" id="cb29-15" data-line-number="15"><span class="kw">shinyApp</span>(<span class="dt">ui =</span> ui, <span class="dt">server =</span> server)</a></code></pre></div>
<p>Now when will select 1 variable, the two objects will describe the same data.</p>
<p><img src="resources/shiny_tutorial/slider.png" />
<img src="resources/shiny_tutorial/hist2.png" />
<img src="resources/shiny_tutorial/sumstats2.png" /></p>
</div>
<div id="prevent-reactions-with-isolate" class="section level3">
<h3><span class="header-section-number">5.8.5</span> Prevent reactions with <code>isolate()</code></h3>
<p>Sometimes we might want to delay a reactive function. For example, the following shiny app plots a scatterplot between 2 variables of the user’s choose and also allows the user to give the plot a customized title. So there are 3 inputs: the title of the scatterplot, an x variable and a y variable. With our regular code, the title will change instantaneously as the user types.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="co"># Before</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2">ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb30-3" data-line-number="3">  <span class="kw">textInput</span>(<span class="dt">inputId =</span> <span class="st">&quot;title&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Enter a title&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;displacement vs mpg&quot;</span>),</a>
<a class="sourceLine" id="cb30-4" data-line-number="4">  <span class="kw">selectInput</span>(<span class="st">&#39;xcol&#39;</span>, <span class="st">&#39;X Variable&#39;</span>, <span class="kw">colnames</span>(cars_info)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>)]),</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">  <span class="kw">selectInput</span>(<span class="st">&#39;ycol&#39;</span>, <span class="st">&#39;Y Variable&#39;</span>, <span class="kw">colnames</span>(cars_info)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>)], <span class="dt">selected=</span><span class="kw">colnames</span>(cars_info)[[<span class="dv">4</span>]]),</a>
<a class="sourceLine" id="cb30-6" data-line-number="6">  <span class="kw">plotOutput</span>(<span class="st">&#39;scatterplot&#39;</span>)</a>
<a class="sourceLine" id="cb30-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb30-8" data-line-number="8"></a>
<a class="sourceLine" id="cb30-9" data-line-number="9">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</a>
<a class="sourceLine" id="cb30-10" data-line-number="10">  output<span class="op">$</span>scatterplot &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb30-11" data-line-number="11">    <span class="kw">plot</span>(cars_info[, <span class="kw">c</span>(input<span class="op">$</span>xcol, input<span class="op">$</span>ycol)], <span class="dt">main =</span> input<span class="op">$</span>title)</a>
<a class="sourceLine" id="cb30-12" data-line-number="12">  })</a>
<a class="sourceLine" id="cb30-13" data-line-number="13">}</a>
<a class="sourceLine" id="cb30-14" data-line-number="14"></a>
<a class="sourceLine" id="cb30-15" data-line-number="15"><span class="kw">shinyApp</span>(<span class="dt">ui =</span> ui, <span class="dt">server =</span> server)</a></code></pre></div>
<p><img src="resources/shiny_tutorial/box2.png" />
<img src="resources/shiny_tutorial/sp1.png" /></p>
<p>Say we do not want the title to change until the user has chosen two variables. In this case, we can use <code>isolate()</code> to isolate the input title. It returns the result as a non-reactive value. That means the observed object will only react to its changes when other inputs also change.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</a>
<a class="sourceLine" id="cb31-2" data-line-number="2">  output<span class="op">$</span>scatterplot &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb31-3" data-line-number="3">    <span class="kw">plot</span>(cars_info[, <span class="kw">c</span>(input<span class="op">$</span>xcol, input<span class="op">$</span>ycol)], </a>
<a class="sourceLine" id="cb31-4" data-line-number="4">         <span class="co"># This line isolates the input title</span></a>
<a class="sourceLine" id="cb31-5" data-line-number="5">         <span class="dt">main =</span> <span class="kw">isolate</span>({input<span class="op">$</span>title}))</a>
<a class="sourceLine" id="cb31-6" data-line-number="6">  })</a>
<a class="sourceLine" id="cb31-7" data-line-number="7">}</a></code></pre></div>
</div>
<div id="trigger-code-with-observeevent" class="section level3">
<h3><span class="header-section-number">5.8.6</span> Trigger code with <code>observeEvent()</code></h3>
<p>we can create an action button or link whose value is initially zero, and increments by one each time it is pressed.</p>
<p>When we have an input like action button, we can trigger a response when the user clicks on the button by using <code>observeEvent()</code> function. Examples of an action button include <code>download</code> which allows the user to download a file.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">actionButton</span>(<span class="dt">inputId =</span> <span class="st">&quot;download&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Download&quot;</span>)</a></code></pre></div>
<p>The <code>observeEvent()</code> function takes two arguments: the first argument is the reactive value(s) it responds to. In our example, it will be the action button. The second armgument is a code block which runs behind the scene whenever the input changes.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">observeEvent</span>(input<span class="op">$</span>download, {<span class="kw">print</span>(input<span class="op">$</span>download)})</a></code></pre></div>
<p>Here is how we can use it in our app. Every time we click the Go! button, the observer will update, which is running the block of code <code>print(as.numeric(input$goButton)</code>. The result won’t appear in the user panel, but to appear back of our app.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb34-2" data-line-number="2">  <span class="kw">actionButton</span>(<span class="dt">inputId =</span> <span class="st">&quot;download&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Download&quot;</span>)</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">)</a>
<a class="sourceLine" id="cb34-4" data-line-number="4"></a>
<a class="sourceLine" id="cb34-5" data-line-number="5">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</a>
<a class="sourceLine" id="cb34-6" data-line-number="6">  <span class="kw">observeEvent</span>(input<span class="op">$</span>downloadn, {</a>
<a class="sourceLine" id="cb34-7" data-line-number="7">    <span class="kw">print</span>(<span class="kw">as.numeric</span>(input<span class="op">$</span>download))</a>
<a class="sourceLine" id="cb34-8" data-line-number="8">  })</a>
<a class="sourceLine" id="cb34-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb34-10" data-line-number="10"></a>
<a class="sourceLine" id="cb34-11" data-line-number="11"><span class="kw">shinyApp</span>(<span class="dt">ui =</span> ui, <span class="dt">server =</span> server) </a></code></pre></div>
<p><img src="resources/shiny_tutorial/button.png" /></p>
<p><img src="resources/shiny_tutorial/out.png" /></p>
<p>Along with <code>observeEvent()</code> which triggers code, there’s another function called <code>observe()</code>, which does the same thing and it’s a parallel of <code>observeEvent()</code>. But its syntax is more like <code>render*()</code> functions. We just give a block of code to it and it will respond to every reactive value in the code.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw">observe</span>({<span class="kw">print</span>(input<span class="op">$</span>download)})</a></code></pre></div>
</div>
<div id="delay-reactions-with-eventreactive" class="section level3">
<h3><span class="header-section-number">5.8.7</span> Delay reactions with <code>eventReactive()</code></h3>
<p>Sometimes we don’t want the outputs to change as soon as the user changes some input in the user interface. Instead, we would like to change them when the user clicks an ‘update’ button. In others words, we hope to prevent the output from updating until the user hits the button.</p>
<p>The way to do this in Shiny is with the function <code>eventReactive()</code>. It creates a reactive expression that only responds to specific values, similar to <code>reactive()</code> but having different syntax. First we give a reactive value to it. The second argument is the code the function uses to build or rebuild the object when it’s clicked. In addition, similar to <code>observeEvent()</code>, the expression treats this block of code as if it has been isolated with <code>isolate()</code>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">data &lt;-<span class="st"> </span><span class="kw">eventReactive</span>(input<span class="op">$</span>update, {<span class="kw">rnorm</span>(input<span class="op">$</span>num)})</a></code></pre></div>
<p>Let’s look at the entire code.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb37-2" data-line-number="2">  <span class="kw">selectInput</span>(<span class="dt">inputId =</span> <span class="st">&quot;varname&quot;</span>, </a>
<a class="sourceLine" id="cb37-3" data-line-number="3">              <span class="dt">label =</span> <span class="st">&quot;Choose a variable&quot;</span>, </a>
<a class="sourceLine" id="cb37-4" data-line-number="4">              <span class="dt">choices =</span> <span class="kw">colnames</span>(cars_info)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">7</span>)]),</a>
<a class="sourceLine" id="cb37-5" data-line-number="5">  <span class="kw">actionButton</span>(<span class="dt">inputId =</span> <span class="st">&quot;update&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Update&quot;</span>),</a>
<a class="sourceLine" id="cb37-6" data-line-number="6">  <span class="kw">plotOutput</span>(<span class="dt">outputId =</span> <span class="st">&quot;hist&quot;</span>)</a>
<a class="sourceLine" id="cb37-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb37-8" data-line-number="8"></a>
<a class="sourceLine" id="cb37-9" data-line-number="9">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</a>
<a class="sourceLine" id="cb37-10" data-line-number="10">  data &lt;-<span class="st"> </span><span class="kw">eventReactive</span>(input<span class="op">$</span>update, {input<span class="op">$</span>varname})</a>
<a class="sourceLine" id="cb37-11" data-line-number="11">  output<span class="op">$</span>hist &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb37-12" data-line-number="12">    <span class="kw">hist</span>(cars_info[[<span class="kw">data</span>()]], <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="kw">data</span>())</a>
<a class="sourceLine" id="cb37-13" data-line-number="13">  })</a>
<a class="sourceLine" id="cb37-14" data-line-number="14">}</a>
<a class="sourceLine" id="cb37-15" data-line-number="15"></a>
<a class="sourceLine" id="cb37-16" data-line-number="16"><span class="kw">shinyApp</span>(<span class="dt">ui =</span> ui, <span class="dt">server =</span> server)</a></code></pre></div>
<p>If we choose different variable without clicking <code>Update</code> button, the histogram would not be updated.</p>
<p><img src="resources/shiny_tutorial/eventreactive.png" /></p>
</div>
<div id="manage-state-with-reactivevalues" class="section level3">
<h3><span class="header-section-number">5.8.8</span> Manage state with <code>reactiveValues()</code></h3>
<p>We know that the reactive value changes whenever a user changes the input in the user panel. But we cannot set these values in our code. Fortunately, although Shiny doesn’t give us the power to overwrite the input values in our app, it gives us the power to create our own list of reactive values, which you can overwrite.</p>
<p><code>reactiveValues()</code> is a function that creates a list of reactive values to manipulate programmatically. Note that it has nothing to do with input reactive values.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">rv &lt;-<span class="st"> </span><span class="kw">reactiveValues</span>(<span class="dt">data =</span> <span class="kw">rnorm</span>(<span class="dv">100</span>))</a></code></pre></div>
<p>Let’s look at an example. If we click <code>mpg vs displacement</code>, the Shiny app would select column <code>mpg</code> and <code>displacement</code> from the cars_info dataset and plot a scatter plot for them. If we click <code>mpg vs weight</code>, it would select column <code>mpg</code> and <code>weight</code> from the cars_info dataset and plot a scatter plot for them.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb39-2" data-line-number="2">  <span class="kw">actionButton</span>(<span class="dt">inputId =</span> <span class="st">&quot;scatter1&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;mpg vs displacement&quot;</span>),</a>
<a class="sourceLine" id="cb39-3" data-line-number="3">  <span class="kw">actionButton</span>(<span class="dt">inputId =</span> <span class="st">&quot;scatter2&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;mpg vs weight&quot;</span>),</a>
<a class="sourceLine" id="cb39-4" data-line-number="4">  <span class="kw">plotOutput</span>(<span class="st">&quot;scatter&quot;</span>)</a>
<a class="sourceLine" id="cb39-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb39-6" data-line-number="6"></a>
<a class="sourceLine" id="cb39-7" data-line-number="7">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</a>
<a class="sourceLine" id="cb39-8" data-line-number="8">  rv1 &lt;-<span class="st"> </span><span class="kw">reactiveValues</span>(<span class="dt">data =</span> cars_info[,<span class="dv">2</span>], <span class="dt">label =</span> <span class="st">&quot;mpg&quot;</span>)</a>
<a class="sourceLine" id="cb39-9" data-line-number="9">  rv2 &lt;-<span class="st"> </span><span class="kw">reactiveValues</span>(<span class="dt">data =</span> cars_info[,<span class="dv">4</span>], <span class="dt">label =</span> <span class="st">&quot;displacement&quot;</span>)</a>
<a class="sourceLine" id="cb39-10" data-line-number="10">  <span class="kw">observeEvent</span>(input<span class="op">$</span>scatter1, {</a>
<a class="sourceLine" id="cb39-11" data-line-number="11">    rv1<span class="op">$</span>data &lt;-<span class="st"> </span>cars_info[,<span class="dv">2</span>] </a>
<a class="sourceLine" id="cb39-12" data-line-number="12">    rv1<span class="op">$</span>label &lt;-<span class="st"> &quot;mpg&quot;</span></a>
<a class="sourceLine" id="cb39-13" data-line-number="13">    rv2<span class="op">$</span>data &lt;-<span class="st"> </span>cars_info[,<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb39-14" data-line-number="14">    rv2<span class="op">$</span>label &lt;-<span class="st"> &quot;displacement&quot;</span></a>
<a class="sourceLine" id="cb39-15" data-line-number="15">    })</a>
<a class="sourceLine" id="cb39-16" data-line-number="16">  <span class="kw">observeEvent</span>(input<span class="op">$</span>scatter2, {</a>
<a class="sourceLine" id="cb39-17" data-line-number="17">    rv1<span class="op">$</span>data &lt;-<span class="st"> </span>cars_info[,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb39-18" data-line-number="18">    rv1<span class="op">$</span>label &lt;-<span class="st"> &quot;mpg&quot;</span></a>
<a class="sourceLine" id="cb39-19" data-line-number="19">    rv2<span class="op">$</span>data &lt;-<span class="st"> </span>cars_info[,<span class="dv">6</span>]</a>
<a class="sourceLine" id="cb39-20" data-line-number="20">    rv2<span class="op">$</span>label &lt;-<span class="st"> &quot;weight&quot;</span></a>
<a class="sourceLine" id="cb39-21" data-line-number="21">    })</a>
<a class="sourceLine" id="cb39-22" data-line-number="22">  output<span class="op">$</span>scatter &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb39-23" data-line-number="23">    <span class="kw">plot</span>(rv1<span class="op">$</span>data, rv2<span class="op">$</span>data, <span class="dt">xlab =</span> rv1<span class="op">$</span>label, <span class="dt">ylab =</span> rv2<span class="op">$</span>label)})</a>
<a class="sourceLine" id="cb39-24" data-line-number="24">}</a>
<a class="sourceLine" id="cb39-25" data-line-number="25"></a>
<a class="sourceLine" id="cb39-26" data-line-number="26"><span class="kw">shinyApp</span>(<span class="dt">ui =</span> ui, <span class="dt">server =</span> server)</a></code></pre></div>
<p><img src="resources/shiny_tutorial/value.png" /></p>
</div>
</div>
<div id="summary" class="section level2">
<h2><span class="header-section-number">5.9</span> 3. Summary</h2>
<p><img src="resources/shiny_tutorial/summary.png" /></p>
<p>Till now, We have learnt both syntax and usage of the basic reactive functions in Shiny. Now there are still some important tips we need to provide.</p>
<p>We should reduce repetition when we create shiny apps. That is to place code where it will be re-run as little as necessary. Keep in mind that,</p>
<ul>
<li><p>Code outside the server function will be run once per R session (worker). So you only need it to run once when setting up the R session, outside the server function. For example, codes that load the help file or some library should be placed outside the server function.</p></li>
<li><p>Code inside the server function will be run once per end user session (connection).</p></li>
<li><p>Code inside the reactive function will be run once per reaction, which means many times.</p></li>
</ul>
<p>If you are interested in Shiny and would like to learn more about it, you can go to the official website or download the documentation of Shiny. The relevant resources are listed below.</p>
<ol style="list-style-type: decimal">
<li>Official website: <a href="https://shiny.rstudio.com/" class="uri">https://shiny.rstudio.com/</a></li>
<li>Documantation of pacakge “Shiny”: <a href="https://cran.r-project.org/web/packages/shiny/shiny.pdf" class="uri">https://cran.r-project.org/web/packages/shiny/shiny.pdf</a></li>
<li>Share your Shiny apps: <a href="https://www.shinyapps.io/" class="uri">https://www.shinyapps.io/</a></li>
<li>Shiny cheat sheet: <a href="https://shiny.rstudio.com/images/shiny-cheatsheet.pdf" class="uri">https://shiny.rstudio.com/images/shiny-cheatsheet.pdf</a></li>
</ol>
<p>The main source of this tutorial is the video on the Shiny official website. We adapted it with some new examples based on the cars dataset. Hope this can help you and any suggestion is welcome.</p>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="stamen-maps-with-ggmap.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="workshops.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jtr13/cc19/edit/master/a_tutorial_of_shiny.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
